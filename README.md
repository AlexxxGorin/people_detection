# Проект: People Detection

## Описание проекта

Данный проект предназначен для автоматического распознавания объектов на видеозаписях с использованием модели YOLO (You Only Look Once).  

Он позволяет:
- Загружать веса модели (`best.pt`), обученные заранее на тренировочном датасете.
- Автоматически обрабатывать все видеофайлы в папке `inputs/`.
- Для каждого кадра видео выполнять детекцию объектов, прорисовывая bounding box и подписи классов.
- Сохранять результат в формате `.mp4` в папку `outputs/`.

Используемые технологии:
- **Python 3.8**
- **Ultralytics YOLO** (YOLOv11)
- **OpenCV** для чтения, обработки и сохранения видео
- **NumPy** для работы с массивами
- **Docker** для запуска на любом OC

## Установка и запуск

1. **Склонировать репозиторий** (или загрузить архив с проектом):
   ```bash
   git clone https://github.com/AlexxxGorin/people_detection
   cd people_detection

### Запуск проекта:

```bash
docker compose up --build -d
```

## Выводы по результатам работы
### Качество распознавания:

- mAP50: 0.875 (результаты получены на валидационнном датасете и представлены в **train.ipynb**)
- Точность распознавания объектов сильно зависит от того, на каком датасете была дообучена модель YOLO. Поэтому чем больше датасет, чем выше будет качество (и тем больше времени нужно)
- На видео распознаются только те объекты, которые были представлены в обучающей выборке (то есть только people)
### Анализ:

- Видео детекция обычно точная, но может возникать путаница при наложении объектов или при неполном их появлении в кадре.
- При высоком FPS и разрешении 4K увеличивается нагрузка на процессор/видеокарту. При необходимости можно снизить разрешение или FPS.
### Дальнейшее улучшение:

- Обучение/дообучение модели: можно расширить тренировочный датасет большим количеством изображений с людьми (например, с того же roboflow), а так же применить больше аугментаций данных (чтобы модель учитывала случаи, когда люди загорожены чем-то, например).
- Настройка гиперпараметров: изменить порог детекции (conf), чтобы уменьшить ложные срабатывания.
### Оптимизация:
- Использовать аппаратное ускорение (CUDA/TensorRT) для повышения скорости обработки.
- При большом количестве входных видео можно реализовать распараллеливание (обрабатывать несколько видео одновременно).

## Архитектура проекта

```plaintext
.
├── .gitignore
├── README.md
├── Dockerfile
├── docker-compose.yml
├── requirements.txt
├── src
│   ├── model
│   │   ├── model.py
│   │   ├── best.pt
│   │   ├── config.py
├── notebooks
│   ├── train.ipynb
├── inputs
│   ├── crowd.mp4
├── outputs
│   ├── crowd_processed.mp4
```
